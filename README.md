# Курсовой Bootcamp Java проект "Реализация парсера новостей РИА-Новости через RSS канал"

## Requirements
- Согласно расписания сервис должен парсить и сохранять в БД публикуемые новости https://ria.ru/export/rss2/archive/index.xml.
Новость должна быть уникальна (можно завязаться на link).
  - Сервис должен предоставлять REST API по агрегации новостей:
  - получение списка новостей за промежуток времени
  - получение N последних новостей
  - аггрегированная информация - количество новостей на определенную дату

  Предусмотреть возможность гибкого изменения конфигурации сервиса

- Репозиторий должен содержать Dockerfile и docker-compose файл с описанием внешних приложений (DB)
- Сервис должен быть готов к горизонтальному масштабированию
- Компоненты: 
  - Сервис парсинга
  - DB
  
## Description

Обучающий проект основан на Java Spring Boot с REST API, базой данных POSTGRES, скриптами миграции LIQUIBASE и 
автоматической работой с Docker контейнерами.

Блок 1.

Структурно, функционал проекта был разделен на две последовательные компоненты, решающие разные задачи:
1. Компонента ParserService - решает задачи чтения данных из URL в XML, а также последовательного парсинга 
сторонними средствами STAX элементов XML, сбора собранных данных в объект.
2. Компонента NewsService - решает задачи сохранения в Базу данных Postgres объектов типа "Новость", 
предоставления REST API по агрегации данных из Базы данных.

Блок 2.

Для реализации чтения данных по расписанию, создан отдельный класс ScheduledTask, класс конфигурации SchedulerConfig, 
которые обращаются к методу компоненты ParserService для цикличного наполнения базы данных.

Блок 3. 

Для возможности гибкого изменения конфигурации сервиса, часть настроек вынесена в свойства приложения.
Настройке подлежат:
- конфигурация подключения к базе данных POSTGRES
- пусть к скрипту создания артефактов БД LIQUIBASE
- настройка URL для доступа к XML новостного сайта
- таймаут соединения к новостному сайту
- частота в мс обращения к новостному сайту

## Installation
### Manual
Для сборки приложения используется Maven, для запуска приложения требуется Postgresql
### Docker compose
В корневой папке проекта находится файл docker-compose.yml, который позволяет развернуть, подготовить и запустить в Docker:
* Postgresql
* Redis
* Application
Перейти в каталог с проектом, запустить cmd.exe, выполнить команду docker-compose up --build

## Endpoints
Актуальное описание `Swagger`:
* [http://localhost:8080/api/swagger-ui/index.html](http://localhost:8080/api/swagger-ui/index.html)

### API получения списка новостей за промежуток времени:
#### [http://localhost:8080/api/swagger-ui/index.html#/news-controller/getBetweenDateNews](http://localhost:8080/api/swagger-ui/index.html#/news-controller/getBetweenDateNews) `GET`: перечень всех новостей за промежуток времени
Формат ввода дат:
- Дата начала 2024-08-23T07:40:00
- Дата завершения 2024-08-23T07:55:00

Пример успешного **HTTP** ответа с кодом **200** в формате `JSON`:
```json
{
  "news": [
    {
      "title": "Трамп раскритиковал программную речь Харрис",
      "link": "https://ria.ru/20240823/tramp-1967940686.html",
      "pub_date": "2024-08-23T07:40:18"
    },
    {
      "title": "Спасатели вывели из лесного пожара в Домбае 236 человек",
      "link": "https://ria.ru/20240823/evakuatsiya-1967940866.html",
      "pub_date": "2024-08-23T07:42:03"
    },
    {
      "title": "Россияне с атакованного у Йемена судна прибыли в Джибути",
      "link": "https://ria.ru/20240823/rossiyane-1967941015.html",
      "pub_date": "2024-08-23T07:46:19"
    },
    {
      "title": "Украинский беспилотник атаковал Еленовку в ДНР",
      "link": "https://ria.ru/20240823/obstrel-1967941254.html",
      "pub_date": "2024-08-23T07:51:36"
    }
  ]
}
```
При некорректном вводе даты:
```json
{
"message": "Probably, invalid format data. Please, check and try again"
}
```

### API получения N последних новостей:
#### [http://localhost:8080/api/swagger-ui/index.html#/news-controller/getLastCountNews) `GET`: получение N последних новостей
Формат ввода числа:
- 2 

Пример успешного **HTTP** ответа с кодом **200** в формате `JSON`:
```json
{
  "news": [
    {
      "title": "Украинский беспилотник атаковал Еленовку в ДНР",
      "link": "https://ria.ru/20240823/obstrel-1967941254.html",
      "pub_date": "2024-08-23T07:51:36"
    },
    {
      "title": "В Палестине заявили, что не будут брать ответственность за действия ХАМАС",
      "link": "https://ria.ru/20240823/palestina-1967941513.html",
      "pub_date": "2024-08-23T07:55:19"
    }
  ]
}
```

### API получения количества новостей на определенную дату:
#### [http://localhost:8080/api/swagger-ui/index.html#/news-controller/getCountNewsInDate) `GET`: получение количества новостей на дату
Формат ввода даты:
- 2024-08-23

Пример успешного **HTTP** ответа с кодом **200**: 123

При некорректном вводе даты:
```json
{
"message": "Probably, invalid format data. Please, check and try again"
}
```

## Advancement

Дальнейшее развитие проекта возможно путем замены парсера STAX на более лаконичный, например ROME или JSOUP.
Также, для ускорения процесса зачитки информации по url перед помещением в БД POSTGRES возможно использование 
кэша через REDIS: сохранять в REDIS записи GUID за последние 2 дня, аналогичный процесс возможен со стороны чтения:
запись в кэш запросов, с переменной очисткой буфера.
